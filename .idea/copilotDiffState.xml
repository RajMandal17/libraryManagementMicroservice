<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/api-gateway/src/main/java/com/library/gateway/config/GatewayConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gateway/src/main/java/com/library/gateway/config/GatewayConfig.java" />
              <option name="updatedContent" value="package com.library.gateway.config;&#10;&#10;import org.springframework.cloud.gateway.route.RouteLocator;&#10;import org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;&#10;/**&#10; * Gateway Routes Configuration&#10; * &#10; * Configures routes programmatically for better control and documentation.&#10; * This provides an alternative to application.properties configuration.&#10; * &#10; * Route Components:&#10; * 1. ID - Unique identifier for the route&#10; * 2. URI - Destination (lb:// means load-balanced via Eureka)&#10; * 3. Predicates - Conditions to match requests&#10; * 4. Filters - Modifications to requests/responses&#10; * &#10; * Learning: Spring Cloud Gateway Features&#10; * &#10; * Load Balancing (lb://):&#10; *    - Automatically distributes load across instances&#10; *    - Uses Eureka to discover available instances&#10; *    - Built-in ribbon/spring-cloud-loadbalancer integration&#10; * &#10; * Path Predicates:&#10; *    - Match based on request path&#10; *    - Support patterns like /service/**&#10; * &#10; * Filters:&#10; *    - StripPrefix: Remove path segments before forwarding&#10; *    - AddRequestHeader: Add headers to requests&#10; *    - AddResponseHeader: Add headers to responses&#10; *    - CircuitBreaker: Handle failures gracefully&#10; *    - RateLimiter: Control request rates&#10; * &#10; * Example Flow:&#10; * Request: http://localhost:8080/book-service/api/books&#10; * Step 1: Gateway receives request&#10; * Step 2: Matches route: /book-service/**&#10; * Step 3: Applies StripPrefix(1): removes /book-service&#10; * Step 4: Asks Eureka: &quot;Where is BOOK-SERVICE?&quot;&#10; * Step 5: Eureka responds: &quot;localhost:8081&quot;&#10; * Step 6: Forwards to: http://localhost:8081/api/books&#10; * Step 7: Returns response to client&#10; */&#10;@Configuration&#10;public class GatewayConfig {&#10;&#10;    /**&#10;     * Define routes programmatically&#10;     * &#10;     * This bean is optional - routes can be configured in application.properties&#10;     * However, Java configuration provides:&#10;     * - Type safety&#10;     * - Better IDE support&#10;     * - Easier to add complex logic&#10;     * - Easier to test&#10;     */&#10;    @Bean&#10;    public RouteLocator customRouteLocator(RouteLocatorBuilder builder) {&#10;        return builder.routes()&#10;                // Route 1: Book Service&#10;                .route(&quot;book-service-route&quot;, r -&gt; r&#10;                        .path(&quot;/book-service/**&quot;)&#10;                        .filters(f -&gt; f&#10;                                .stripPrefix(1)  // Remove /book-service from path&#10;                                .addResponseHeader(&quot;X-Gateway&quot;, &quot;API-Gateway&quot;)  // Add custom header&#10;                                .retry(3))  // Retry failed requests up to 3 times&#10;                        .uri(&quot;lb://BOOK-SERVICE&quot;))  // Load-balanced to BOOK-SERVICE&#10;                &#10;                // Route 2: User Service&#10;                .route(&quot;user-service-route&quot;, r -&gt; r&#10;                        .path(&quot;/user-service/**&quot;)&#10;                        .filters(f -&gt; f&#10;                                .stripPrefix(1)  // Remove /user-service from path&#10;                                .addResponseHeader(&quot;X-Gateway&quot;, &quot;API-Gateway&quot;)&#10;                                .retry(3))&#10;                        .uri(&quot;lb://USER-SERVICE&quot;))  // Load-balanced to USER-SERVICE&#10;                &#10;                // Route 3: Eureka Dashboard&#10;                .route(&quot;eureka-route&quot;, r -&gt; r&#10;                        .path(&quot;/eureka/**&quot;)&#10;                        .uri(&quot;http://localhost:8761&quot;))  // Direct to Eureka (no load balancing needed)&#10;                &#10;                .build();&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>